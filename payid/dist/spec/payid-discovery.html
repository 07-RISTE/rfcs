<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>PayID Discovery</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
      /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
      a.info {
          /* This is the key. */
          position: relative;
          z-index: 24;
          text-decoration: none;
      }
      a.info:hover {
          z-index: 25;
          color: #FFF; background-color: #900;
      }
      a.info span { display: none; }
      a.info:hover span.info {
          /* The span will display just on :hover state. */
          display: block;
          position: absolute;
          font-size: smaller;
          top: 2em; left: -5em; width: 15em;
          padding: 2px; border: 1px solid #333;
          color: #900; background-color: #EEE;
          text-align: left;
      }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  max-width: 55em;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.2" rel="Chapter" title="2 Terminology">
<link href="#rfc.section.3" rel="Chapter" title="3 Example Usage">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 Automated PayID Discovery by a Wallet">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 Manual PayID Discovery by a Wallet">
<link href="#rfc.section.4" rel="Chapter" title="4 PayID Discovery Protocol">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 Automated Mode">
<link href="#rfc.section.4.1.1" rel="Chapter" title="4.1.1 Automated Mode URL Assembly">
<link href="#rfc.section.4.1.2" rel="Chapter" title="4.1.2 PayID Disovery JRDs">
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 Manual Mode">
<link href="#rfc.section.4.2.1" rel="Chapter" title="4.2.1 Manual Mode URL Assembly">
<link href="#rfc.section.5" rel="Chapter" title="5 Cross-Origin Resource Sharing (CORS)">
<link href="#rfc.section.6" rel="Chapter" title="6 Access Control">
<link href="#rfc.section.7" rel="Chapter" title="7 Hosted PayID Discovery Services">
<link href="#rfc.section.8" rel="Chapter" title="8 Security Considerations">
<link href="#rfc.section.9" rel="Chapter" title="9 IANA Considerations">
<link href="#rfc.section.9.1" rel="Chapter" title="9.1 New Link Relation Types">
<link href="#rfc.section.10" rel="Chapter" title="10 Acknowledgments">
<link href="#rfc.references" rel="Chapter" title="11 Normative References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content="xml2rfc version 2.10.3 - https://tools.ietf.org/tools/xml2rfc" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />

  <meta name="dct.creator" content="Fuelling, D." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-fuelling-payid-discovery-01" />
  <meta name="dct.issued" scheme="ISO8601" content="2020-04-16" />
  <meta name="dct.abstract" content="This specification defines the PayID Discovery protocol, which can be used to discover information about a 'payid' URI using standard HTTP methods." />
  <meta name="description" content="This specification defines the PayID Discovery protocol, which can be used to discover information about a 'payid' URI using standard HTTP methods." />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Network Working Group</td>
<td class="right">D. Fuelling</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Ripple</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">April 16, 2020</td>
</tr>
<tr>
<td class="left">Expires: October 18, 2020</td>
<td class="right"></td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">PayID Discovery<br />
  <span class="filename">draft-fuelling-payid-discovery-01</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>This specification defines the PayID Discovery protocol, which can be used to discover information about a 'payid' URI using standard HTTP methods.</p>
<p>The primary use-case of this protocol is to define how to transform a PayID URI into a URL that can be used with other protocols.</p>
<h1><a>Feedback</a></h1>
<p>This specification is a part of the <a href="https://payid.org/">PayID Protocol</a> work.  Feedback related to this specification should be sent to <a href="mailto:payid@ripple.com">payid@ripple.com</a>.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of This Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet-Drafts is at https://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on October 18, 2020.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2020 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (https://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>2.   <a href="#rfc.section.2">Terminology</a>
</li>
<li>3.   <a href="#rfc.section.3">Example Usage</a>
</li>
<ul><li>3.1.   <a href="#rfc.section.3.1">Automated PayID Discovery by a Wallet</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">Manual PayID Discovery by a Wallet</a>
</li>
</ul><li>4.   <a href="#rfc.section.4">PayID Discovery Protocol</a>
</li>
<ul><li>4.1.   <a href="#rfc.section.4.1">Automated Mode</a>
</li>
<ul><li>4.1.1.   <a href="#rfc.section.4.1.1">Automated Mode URL Assembly</a>
</li>
<li>4.1.2.   <a href="#rfc.section.4.1.2">PayID Disovery JRDs</a>
</li>
</ul><li>4.2.   <a href="#rfc.section.4.2">Manual Mode</a>
</li>
<ul><li>4.2.1.   <a href="#rfc.section.4.2.1">Manual Mode URL Assembly</a>
</li>
</ul></ul><li>5.   <a href="#rfc.section.5">Cross-Origin Resource Sharing (CORS)</a>
</li>
<li>6.   <a href="#rfc.section.6">Access Control</a>
</li>
<li>7.   <a href="#rfc.section.7">Hosted PayID Discovery Services</a>
</li>
<li>8.   <a href="#rfc.section.8">Security Considerations</a>
</li>
<li>9.   <a href="#rfc.section.9">IANA Considerations</a>
</li>
<ul><li>9.1.   <a href="#rfc.section.9.1">New Link Relation Types</a>
</li>
</ul><li>10.   <a href="#rfc.section.10">Acknowledgments</a>
</li>
<li>11.   <a href="#rfc.references">Normative References</a>
</li>
<li><a href="#rfc.authors">Author's Address</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> <a href="#introduction" id="introduction">Introduction</a>
</h1>
<p id="rfc.section.1.p.1">PayID Discovery is used to transform a PayID URI <a href="#PAYID-URI" class="xref">[PAYID-URI]</a> into a URL that can be used by higher-order protocols using HTTP.</p>
<p id="rfc.section.1.p.2">This document specifies two modes of PayID discovery: one using Webfinger <a href="#RFC7033" class="xref">[RFC7033]</a> to resolve a corresponding URL from a PayID URI in an automated fashion; and one using a manual, fallback mechanism to assemble a URL from a PayID URI by-hand.</p>
<p id="rfc.section.1.p.3">In 'automated' mode, a PayID can be presented to a service endpoint that supports PayID Discovery. The resource returns a Webfinger-compliant JavaScript Object Notation (JSON) <a href="#RFC4627" class="xref">[RFC4627]</a> object that can be used to assemble PayID URL as defined by the procedure in section 4.1 of this document.</p>
<p id="rfc.section.1.p.4">Conversely, in "manual" mode, a PayID can be decomposed into a URL, without any intermediate server interaction, simply by transposing portions of the PayID into a URL format defined in section 4.2 of this document.</p>
<p id="rfc.section.1.p.5">It should be noted that "manual" mode does not allow divergence between the string characters in a PayID URI and any corresponding URL. Conversely, "automatic" mode does allow such divergence. For example, in "manual" mode, the PayID 'alice$example.com' MUST always map to the URL 'https://example.com/alice', whereas in "automatic" mode that same PayID URI can map to any arbitrary URL structure determined buy the service provider, such as 'https://example.com/users/alice'.</p>
<p id="rfc.section.1.p.6">Information returned via PayID Discovery might be for direct human consumption (e.g., looking up someone's Bitcoin address), or it might be used by systems to help carry out some operation (e.g., facilitating, with additional security mechanisms, protocols to support compliance or other legal requirements necessary to facilitate a payment).</p>
<p id="rfc.section.1.p.7">The information returned via this protocol is intended to be static in nature, and, as such, PayID Discovery is not intended to be used to return dynamic information like a payment account balance or the current status of an account.</p>
<p id="rfc.section.1.p.8">PayID Discovery is designed to be used across many applications. Use of PayID Discovery is illustrated in the examples in Section 3 and described more formally in Section 4.</p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> <a href="#terminology" id="terminology">Terminology</a>
</h1>
<p id="rfc.section.2.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119" class="xref">[RFC2119]</a>.</p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#example-usage" id="example-usage">Example Usage</a>
</h1>
<p id="rfc.section.3.p.1">This section shows sample uses of PayID Discovery in several hypothetical scenarios.</p>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> <a href="#automated-payid-discovery-by-a-wallet" id="automated-payid-discovery-by-a-wallet">Automated PayID Discovery by a Wallet</a>
</h1>
<p id="rfc.section.3.1.p.1">Suppose Alice wishes to send a friend some XRP from a web-based wallet provider that Alice has an account on. Alice would log-in to the wallet provider and enter Bob's PayID (say, <samp>bob$receiver.example.com</samp>) into the wallet UI to start the payment.</p>
<p id="rfc.section.3.1.p.2">The Wallet application would first perform a WebFinger query looking for the PayID Discovery service provider, like this:</p>
<pre>
 GET /.well-known/webfinger?
       resource=payid%3Abob%24receiver.example.com
       HTTP/1.1
 Host: receiver.example.com
</pre>
<p id="rfc.section.3.1.p.3">The server might respond like this:</p>
<pre>
 HTTP/1.1 200 OK
 Access-Control-Allow-Origin: *
 Content-Type: application/jrd+json

 {
   "subject" : "payid:bob$receiver.exmaple.com",
   "links" :
   [
     {  
       "rel": "http://payid.org/rel/discovery/1.0 ",
       "type": "application/payid-uri-template",
       "href": "https://receiver.exmaple.com/users/{acctpart}"
     }
   ]
 }
</pre>
<p id="rfc.section.3.1.p.4">Alice's wallet then uses URL template found in the <samp>href</samp> property to assemble a PayId-specific URL, <samp>https://receiver.exmaple.com/users/bob</samp>.</p>
<p id="rfc.section.3.1.p.5">Per RFC-7033, Webfinger requests can be filtered by using a "rel" parameter in the Webfinger request. Because support for the "rel" parameter is not required nor guaranteed, the client must not assume the "links" array will contain only the link relations related to PayID Discovery.</p>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> <a href="#manual-payid-discovery-by-a-wallet" id="manual-payid-discovery-by-a-wallet">Manual PayID Discovery by a Wallet</a>
</h1>
<p id="rfc.section.3.2.p.1">Suppose Alice wishes to send a friend some XRP from a web-based wallet provider that Alice has an account on. However, in this example, let's assume that the PayID Alice is wanting to pay doesn't support "automated" PayID discovery (i.e., the receiver's server doesn't support Webfinger).</p>
<p id="rfc.section.3.2.p.2">Alice would log-in to her wallet provider and enter Bob's PayID (say <samp>bob$receiver.example.com</samp>) to make a payment.</p>
<p id="rfc.section.3.2.p.3">The Wallet application would first attempt a WebFinger query as in the example above, like this:</p>
<pre>
   GET /.well-known/webfinger?
         resource=payid%3Abob%24receiver.example.com&amp;
         HTTP/1.1
   Host: receiver.example.com
</pre>
<p id="rfc.section.3.2.p.4">However, in this case the <samp>receiver.exapmle.com</samp> server doesn't support "automated" PayID Discovery, so the server responds like this:</p>
<pre>
   HTTP/1.1 404 NOT FOUND
</pre>
<p id="rfc.section.3.2.p.5">Because Alice's Wallet can utilize "manual" PayID Discovery, the wallet software merely transforms <samp>bob$receiever.example.com</samp> into the URL <samp>https://receiver.example.com/bob</samp>. Alice's wallet then uses that URL to continue making a PayID payment.</p>
<p id="rfc.section.3.2.p.6">It should be noted that "manual" mode does not allow the PayID URI to diverge from the underlying URL returned via PayID Discovery. Because of this, "automated" PayID Discovery is generally preferred.</p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#payid-discovery-protocol" id="payid-discovery-protocol">PayID Discovery Protocol</a>
</h1>
<p id="rfc.section.4.p.1">The PayID Discovery protocol is used to request information about an entity identified by a query target that is a PayID URI.</p>
<p id="rfc.section.4.p.2">The result of PayID Discovery is a URL that can be used for any other protocol purposes that are outside the scope of this document.</p>
<p id="rfc.section.4.p.3">To this end, PayID Discovery defines two modes of operation, "manual" and "automated" (defined below). Clients SHOULD attempt "automated mode" first.  Failing that, "manual mode" SHOULD be used.</p>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> <a href="#automated-mode" id="automated-mode">Automated Mode</a>
</h1>
<p id="rfc.section.4.1.p.1">This mode utilizes the Webfinger specification in a narrowly defined profile.</p>
<p id="rfc.section.4.1.p.2">A WebFinger resource is always given a query target, which is another URI that identifies the entity whose information is sought. For PayID Discovery, this supplied URI MUST always be a valid PayID URI, and must be supplied to the WebFinger service according to the rules defined in section 4.1 of Webfinger <a href="#RFC7033" class="xref">[RFC7033]</a>.</p>
<p id="rfc.section.4.1.p.3">In this profile, the WebFinger resource returns a JSON Resource Descriptor (JRD) as the resource representation to convey information about the requested PayID. The returned JRD MUST have a URI template that can be used to map the source PayID to a de-referencable URL.</p>
<h1 id="rfc.section.4.1.1">
<a href="#rfc.section.4.1.1">4.1.1.</a> <a href="#automated-mode-url-assembly" id="automated-mode-url-assembly">Automated Mode URL Assembly</a>
</h1>
<p id="rfc.section.4.1.1.p.1">If a PayID Discovery server returns a JRD that conforms to section 4.1.2 below, then the following ruleset SHOULD be used to transform the corresponding PayID URI into a URL:</p>
<p></p>

<ol>
<li>Decompose the PayID URI into its component parts, per <a href="#PAYID-URI" class="xref">[PAYID-URI]</a>, capturing the <samp>acctpart</samp> and <samp>host</samp> values.</li>
<li>Repalce the <samp>acctpart</samp> template variable in the URI template returned from #1 above and with the <samp>acctpart</samp> portion of the PayID URI.</li>
</ol>
<p id="rfc.section.4.1.1.p.3">The resulting URL can be used according to the rules defined in any other protocol.</p>
<h1 id="rfc.section.4.1.2">
<a href="#rfc.section.4.1.2">4.1.2.</a> <a href="#payid-disovery-jrds" id="payid-disovery-jrds">PayID Disovery JRDs</a>
</h1>
<p id="rfc.section.4.1.2.p.1">Any JRD returned via Webfinger MUST be compatible with section 4.4 of RFC-7033. As such, this protocol defines a single compatible 'link' as follows:</p>
<p></p>

<ul>
<li>'rel': <samp>http://payid.org/rel/discovery/1.0</samp>
</li>
<li>'type': <samp>application/payid-uri-template</samp>
</li>
<li>'href': A URI template as defined by <a href="#RFC6570" class="xref">[RFC6570]</a> that specifies an <samp>{acctpart}</samp> template value specifying where in the service provider's URL-space the account identifier should be located.</li>
</ul>
<h1 id="rfc.section.4.2">
<a href="#rfc.section.4.2">4.2.</a> <a href="#manual-mode" id="manual-mode">Manual Mode</a>
</h1>
<p id="rfc.section.4.2.p.1">If "Automated" mode is not supported or otherwise fails to yield a PayID URL, then a URL can be assembled manually.</p>
<h1 id="rfc.section.4.2.1">
<a href="#rfc.section.4.2.1">4.2.1.</a> <a href="#manual-mode-url-assembly" id="manual-mode-url-assembly">Manual Mode URL Assembly</a>
</h1>
<p id="rfc.section.4.2.1.p.1">If "Automated" mode is not supported or otherwise fails to yield a PayID URL, then the following predefined ruleset SHOULD instead be used to transform a PayID URI into a URL.</p>
<p></p>

<ol>
<li>Decompose the PayID URI into its component parts, per <a href="#PAYID-URI" class="xref">[PAYID-URI]</a>, capturing the <samp>acctpart</samp> and <samp>host</samp> values.</li>
<li>Using the <samp>acctpart</samp> and the <samp>host</samp>, assemble a URL according to the following URL template:<samp>https://{host}/{acctpart}</samp>
</li>
</ol>
<p id="rfc.section.4.2.1.p.3">The resulting URL can be used according to the rules defined in any other protocol.</p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#cross-origin-resource-sharing-cors" id="cross-origin-resource-sharing-cors">Cross-Origin Resource Sharing (CORS)</a>
</h1>
<p id="rfc.section.5.p.1">PayID Discovery resources might not be accessible from a web browser due to "Same-Origin" policies. See section 5 of RFC-7033 for CORS considerations that apply to both "manual" and "automated" PayID Discovery modes.</p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#access-control" id="access-control">Access Control</a>
</h1>
<p id="rfc.section.6.p.1">As with all web resources, access to the PayID Discovery resource could require authentication. See section 6 of RFC-7033 for Access Control considerations that could apply to both "manual" and "automated" PayID Discovery modes.</p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#hosted-payid-discovery-services" id="hosted-payid-discovery-services">Hosted PayID Discovery Services</a>
</h1>
<p id="rfc.section.7.p.1">As with most services provided on the Internet, it is possible for a domain owner to utilize "hosted" WebFinger services. Consult section 7 of RFC-7033 for considerations that could apply to both "manual" and "automated" PayID Discovery when hosted by a third-party.</p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> <a href="#security-considerations" id="security-considerations">Security Considerations</a>
</h1>
<p id="rfc.section.8.p.1">Various security considerations should be taken into account for PayID Discovery.</p>
<p id="rfc.section.8.p.2">Among other resource, consult section 9 of RFC-7033 and section 7 of <a href="#RFC3986" class="xref">[RFC3986]</a> for important security considerations involved in PayID Discovery.</p>
<h1 id="rfc.section.9">
<a href="#rfc.section.9">9.</a> <a href="#iana-considerations" id="iana-considerations">IANA Considerations</a>
</h1>
<h1 id="rfc.section.9.1">
<a href="#rfc.section.9.1">9.1.</a> <a href="#new-link-relation-types" id="new-link-relation-types">New Link Relation Types</a>
</h1>
<p id="rfc.section.9.1.p.1">This document defines the following Link relation type per RFC-7033:</p>
<p></p>

<ul>
<li>Relation Type ('rel'): <samp>http://payid.org/rel/discovery/1.0</samp>
</li>
<li>Media Type: <samp>application/payid-uri-template</samp>
</li>
<li>Description: PayID Discovery URI Template, version 1.0</li>
</ul>
<p id="rfc.section.9.1.p.3">See section 3 for examples of this type of Link.</p>
<h1 id="rfc.section.10">
<a href="#rfc.section.10">10.</a> <a href="#acknowledgments" id="acknowledgments">Acknowledgments</a>
</h1>
<p id="rfc.section.10.p.1">This document was heavily influenced by, and builds upon, the Webfinger protocol as defined in RFC-7033 (adapted for a payments use-case). The author would like to acknowledge the contributions of everyone who worked on that and related specifications.</p>
<p id="rfc.section.10.p.2">In addition, the author would like to acknowledge everyone who provided feedback and use-cases for this derivative specification.</p>
<h1 id="rfc.references">
<a href="#rfc.references">11.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="PAYID-URI">[PAYID-URI]</b></td>
<td class="top">
<a>Fuelling, D.</a>, "<a href="https://tbd.example.com/">The 'payid' URI Scheme</a>", n.d..</td>
</tr>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a>Bradner, S.</a>, "<a href="https://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, DOI 10.17487/RFC2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3986">[RFC3986]</b></td>
<td class="top">
<a>Berners-Lee, T.</a>, <a>Fielding, R.</a> and <a>L. Masinter</a>, "<a href="https://tools.ietf.org/html/rfc3986">Uniform Resource Identifier (URI): Generic Syntax</a>", STD 66, RFC 3986, DOI 10.17487/RFC3986, January 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4627">[RFC4627]</b></td>
<td class="top">
<a>Crockford, D.</a>, "<a href="https://tools.ietf.org/html/rfc4627">The application/json Media Type for JavaScript Object Notation (JSON)</a>", RFC 4627, DOI 10.17487/RFC4627, July 2006.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6570">[RFC6570]</b></td>
<td class="top">
<a>Gregorio, J.</a>, <a>Fielding, R.</a>, <a>Hadley, M.</a>, <a>Nottingham, M.</a> and <a>D. Orchard</a>, "<a href="https://tools.ietf.org/html/rfc6570">URI Template</a>", RFC 6570, DOI 10.17487/RFC6570, March 2012.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7033">[RFC7033]</b></td>
<td class="top">
<a>Jones, P.</a>, <a>Salgueiro, G.</a>, <a>Jones, M.</a> and <a>J. Smarr</a>, "<a href="https://tools.ietf.org/html/rfc7033">WebFinger</a>", RFC 7033, DOI 10.17487/RFC7033, September 2013.</td>
</tr>
</tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Author's Address</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">David Fuelling</span> 
	  <span class="n hidden">
		<span class="family-name">Fuelling</span>
	  </span>
	</span>
	<span class="org vcardline">Ripple</span>
	<span class="adr">
	  <span class="vcardline">315 Montgomery Street</span>

	  <span class="vcardline">
		<span class="locality">San Francisco</span>,  
		<span class="region">CA</span> 
		<span class="code">94104</span>
	  </span>
	  <span class="country-name vcardline">US</span>
	</span>
	<span class="vcardline">Phone: -----------------</span>

<span class="vcardline">EMail: <a href="mailto:fuelling@ripple.com">fuelling@ripple.com</a></span>

<span class="vcardline">URI: <a href="https://www.ripple.com">https://www.ripple.com</a></span>

  </address>
</div>

</body>
</html>
